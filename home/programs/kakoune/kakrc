# Generated by home-manager 
set-option global indentwidth 2
add-highlighter global/ number-lines -relative
add-highlighter global/ show-matching
set-option global scrolloff 4,2

nop %sh{
  mkdir -p "$kak_config/autoload"
  ln -s "$kak_runtime/autoload" "$kak_config/autoload/stdlib"
  echo "$kak_runtime"
}

# Map space (or comma) as a leader-like prefix
source "/nix/store/fb0x01jn11mkhd05n53sbi91znmdxdbk-kakplugin-fzf-kak-2022-10-11/share/kak/autoload/plugins/fzf-kak/rc/fzf.kak"
evaluate-commands %sh{
    find -L "/nix/store/fb0x01jn11mkhd05n53sbi91znmdxdbk-kakplugin-fzf-kak-2022-10-11/share/kak/autoload/plugins/fzf-kak/rc/modules/" -type f -name '*.kak' -exec printf 'source "%s"\n' {} \;
}
map global normal <c-p> ': fzf-mode<ret>'

# UI options
set-option global ui_options terminal_set_title=false terminal_status_on_top=false terminal_assistant=none terminal_enable_mouse=true terminal_change_colors=true    terminal_builtin_key_parser=false

# User modes
# Key mappings
# Hooks
hook   global WinSetOption filetype=(haskell|c|cpp|rust|python|javascript|typescript|latex|typst|dart|nix|go|cmake) %{ lsp-enable-window
lsp-inlay-diagnostics-enable window
lsp-inlay-hints-enable window
lsp-inlay-code-lenses-enable window
 }
hook   global WinSetOption filetype=rust %{ hook window -group rust-inlay-hints BufReload .* rust-analyzer-inlay-hints
hook window -group rust-inlay-hints NormalIdle .* rust-analyzer-inlay-hints
hook window -group rust-inlay-hints InsertIdle .* rust-analyzer-inlay-hints
hook -once -always window WinSetOption filetype=.* %{
  remove-hooks window rust-inlay-hints
}
 }
hook   global ModuleLoaded fzf %{ set-option global fzf_highlight_command 'bat' }
hook   global ModuleLoaded fzf-file %{ set-option global fzf_file_command 'fd' }
hook   global ModuleLoaded fzf-grep %{ set-option global fzf_grep_command 'rg'
set-option global fzf_grep_preview_command 'bat'
 }
eval %sh{kak-lsp}
lsp-enable
eval %sh{ kak-tree-sitter -dks --with-highlighting --with-text-objects -vvvvv --init $kak_session }
#eval %sh{kak-lsp --kakoune -s $kak_session}
set global lsp_hover_anchor true
lsp-auto-signature-help-enable
set-option global lsp_hover_anchor true
set-option global lsp_auto_show_code_actions true

set-option global auto_pairs ( ) { } [ ] '"' '"' "'" "'" ` ` “ ” ‘ ’ « » ‹ ›
enable-auto-pairs



hook global RegisterModified '"' %{
  nop %sh{
    printf "%s" "$kak_main_reg_dquote" | wl-copy --no-newline --foreground > /dev/null 2>&1 &
  }
}

map global user p '<a-!>wl-paste --no-newline<ret>'
map global user P '!wl-paste --no-newline<ret>'
map global user R '|wl-paste --no-newline<ret>'

define-command read-wl-clipboard %{
  set-register dquote %sh{
    wl-paste --no-newline
  }
}

